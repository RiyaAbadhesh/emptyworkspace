Adding some code from abadhsh kumar
